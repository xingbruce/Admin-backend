<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Diver Bank Admin Dashboard</title>
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
  <style>
    body {
      overflow-x: hidden;
    }
    #sidebar {
      min-width: 250px;
      max-width: 250px;
      height: 100vh;
      position: fixed;
      top: 0;
      left: 0;
      background-color: #343a40;
      color: white;
      padding-top: 60px;
      transition: all 0.3s;
      z-index: 1040;
    }
    #sidebar.collapsed {
      min-width: 80px;
      max-width: 80px;
      overflow-x: hidden;
      padding-top: 60px;
    }
    #sidebar .nav-link {
      color: #adb5bd;
      font-weight: 500;
    }
    #sidebar .nav-link.active, #sidebar .nav-link:hover {
      color: #fff;
      background-color: #495057;
      border-radius: 4px;
    }
    #sidebar .nav-link .icon {
      width: 24px;
      display: inline-block;
      margin-right: 10px;
      text-align: center;
      font-size: 1.2rem;
    }
    #sidebar.collapsed .nav-link .label {
      display: none;
    }
    #content {
      margin-left: 250px;
      padding: 20px;
      transition: margin-left 0.3s;
    }
    #sidebar.collapsed + #content {
      margin-left: 80px;
    }
    #topbar {
      height: 60px;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      background: white;
      border-bottom: 1px solid #dee2e6;
      z-index: 1050;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 1.5rem;
    }
    #topbar .brand {
      font-weight: 700;
      font-size: 1.25rem;
      color: #343a40;
    }
    #topbar .btn-logout {
      font-weight: 600;
    }
    .section {
      display: none;
    }
    .section.active {
      display: block;
    }
    table th, table td {
      vertical-align: middle !important;
    }
  </style>
</head>
<body>
  <!-- Sidebar -->
  <nav id="sidebar" aria-label="Sidebar Navigation">
    <ul class="nav flex-column px-2">
      <li class="nav-item my-1">
        <a href="#" class="nav-link active" data-section="users" tabindex="0">
          <span class="icon">ðŸ‘¥</span>
          <span class="label">Users</span>
        </a>
      </li>
      <li class="nav-item my-1">
        <a href="#" class="nav-link" data-section="transactions" tabindex="0">
          <span class="icon">ðŸ’³</span>
          <span class="label">Transactions</span>
        </a>
      </li>
      <li class="nav-item my-1">
        <a href="#" class="nav-link" data-section="notifications" tabindex="0">
          <span class="icon">ðŸ””</span>
          <span class="label">Notifications</span>
        </a>
      </li>
      <li class="nav-item mt-4">
        <button id="toggleSidebar" class="btn btn-sm btn-outline-light w-100" type="button" aria-label="Toggle sidebar">
          Toggle Sidebar
        </button>
      </li>
    </ul>
  </nav>

  <!-- Topbar -->
  <header id="topbar">
    <div class="brand">Diver Bank Admin</div>
    <a href="/admin/logout" class="btn btn-outline-danger btn-logout">Logout</a>
  </header>

  <!-- Main content -->
  <main id="content" role="main" tabindex="-1">
    <!-- Users Section -->
    <section id="users" class="section active" aria-labelledby="users-heading">
      <h2 id="users-heading" class="mb-4">User Management</h2>
      <p>Manage users, reset passwords, freeze/unfreeze accounts.</p>
      <table class="table table-hover table-striped align-middle">
        <thead>
          <tr>
            <th>ID</th>
            <th>Username</th>
            <th>Balance</th>
            <th>Broker</th>
            <th>Frozen</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="users-table-body">
          <!-- User rows inserted dynamically -->
        </tbody>
      </table>
    </section>

    <!-- Transactions Section -->
    <section id="transactions" class="section" aria-labelledby="transactions-heading">
      <h2 id="transactions-heading" class="mb-4">Transaction History</h2>
      <p>View, add, and delete mock transactions.</p>
      <table class="table table-hover table-striped align-middle">
        <thead>
          <tr>
            <th>ID</th>
            <th>User ID</th>
            <th>Type</th>
            <th>Amount</th>
            <th>Date</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="transactions-table-body">
          <!-- Transaction rows inserted dynamically -->
        </tbody>
      </table>
      <button id="btnAddTransaction" class="btn btn-primary mt-3">Add Transaction</button>
    </section>

    <!-- Notifications Section -->
    <section id="notifications" class="section" aria-labelledby="notifications-heading">
      <h2 id="notifications-heading" class="mb-4">Notifications</h2>
      <p>Send and manage notifications to users.</p>
      <ul class="list-group" id="notifications-list">
        <!-- Notification items inserted dynamically -->
      </ul>
    </section>
  </main>

  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
    crossorigin="anonymous"
  ></script>
  <script>
    (() => {
      const sidebar = document.getElementById("sidebar");
      const toggleBtn = document.getElementById("toggleSidebar");
      const navLinks = sidebar.querySelectorAll("a.nav-link");
      const sections = document.querySelectorAll(".section");

      // Toggle sidebar collapse
      toggleBtn.addEventListener("click", () => {
        sidebar.classList.toggle("collapsed");
      });

      // Section toggle handler
      navLinks.forEach(link => {
        link.addEventListener("click", e => {
          e.preventDefault();
          const target = e.currentTarget.getAttribute("data-section");
          if (!target) return;

          // Set active link
          navLinks.forEach(lnk => lnk.classList.remove("active"));
          e.currentTarget.classList.add("active");

          // Show corresponding section
          sections.forEach(section => {
            section.classList.toggle("active", section.id === target);
          });
        });
      });

      // Dummy data insertion - you should replace this with API calls
      const users = [
        { id: 1, username: "alice", balance: 5000, broker: "Alpha", is_frozen: false },
        { id: 2, username: "bob", balance: 3000, broker: "Beta", is_frozen: true },
        { id: 3, username: "charlie", balance: 7000, broker: "Gamma", is_frozen: false },
      ];

      const transactions = [
        { id: 101, user_id: 1, type: "Deposit", amount: 1000, date: "2025-08-10" },
        { id: 102, user_id: 2, type: "Withdraw", amount: 200, date: "2025-08-09" },
      ];

      const notifications = [
        { id: 1, message: "Welcome Alice!", date: "2025-08-01" },
        { id: 2, message: "Your account was frozen", date: "2025-08-05" },
      ];

      // Render users
      const usersTableBody = document.getElementById("users-table-body");
      users.forEach(user => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${user.id}</td>
          <td>${user.username}</td>
          <td>$${user.balance.toFixed(2)}</td>
          <td>${user.broker}</td>
          <td>${user.is_frozen ? "Yes" : "No"}</td>
          <td>
            <button class="btn btn-sm btn-warning btn-freeze" data-id="${user.id}">
              ${user.is_frozen ? "Unfreeze" : "Freeze"}
            </button>
            <button class="btn btn-sm btn-danger btn-delete" data-id="${user.id}">Delete</button>
          </td>
        `;
        usersTableBody.appendChild(tr);
      });

      // Render transactions
      const transactionsTableBody = document.getElementById("transactions-table-body");
      transactions.forEach(tx => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${tx.id}</td>
          <td>${tx.user_id}</td>
          <td>${tx.type}</td>
          <td>$${tx.amount.toFixed(2)}</td>
          <td>${tx.date}</td>
          <td>
            <button class="btn btn-sm btn-danger btn-delete-tx" data-id="${tx.id}">Delete</button>
          </td>
        `;
        transactionsTableBody.appendChild(tr);
      });

      // Render notifications
      const notificationsList = document.getElementById("notifications-list");
      notifications.forEach(note => {
        const li = document.createElement("li");
        li.className = "list-group-item d-flex justify-content-between align-items-center";
        li.textContent = note.message;
        const dateSpan = document.createElement("span");
        dateSpan.className = "badge bg-secondary rounded-pill";
        dateSpan.textContent = note.date;
        li.appendChild(dateSpan);
        notificationsList.appendChild(li);
      });

      // TODO: Add event listeners for freeze/unfreeze, delete, add transaction etc.
      // These should call your backend API endpoints via fetch/AJAX

      document.getElementById("btnAddTransaction").addEventListener("click", () => {
        alert("Add Transaction feature to be implemented.");
      });
    })();
  </script>
</body>
</html>
